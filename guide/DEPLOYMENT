# Docker Hub ê¸°ë°˜ ë°°í¬ ê°€ì´ë“œ

## ê°œìš”
ì´ ë¬¸ì„œëŠ” Stock Analysis Agentë¥¼ ë¡œì»¬ì—ì„œ Docker ë¹Œë“œ â†’ Docker Hub ì—…ë¡œë“œ â†’ ì›ê²© ì„œë²„ ë°°í¬ ë°©ì‹ìœ¼ë¡œ ì „í™˜í•˜ëŠ” ì „ì²´ ê°€ì´ë“œì…ë‹ˆë‹¤.

## ğŸ“ ìƒì„±ëœ íŒŒì¼ ëª©ë¡

### Docker Hub ì„¤ì •
- `DOCKER_HUB_SETUP.md`: Docker Hub ë ˆí¬ì§€í† ë¦¬ ì„¤ì • ê°€ì´ë“œ

### ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ (`scripts/` ë””ë ‰í† ë¦¬)
- `build-images.sh`: ë¡œì»¬ Docker ì´ë¯¸ì§€ ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸
- `push-images.sh`: Docker Hub ì´ë¯¸ì§€ ì—…ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸
- `deploy-remote.sh`: ì›ê²© ì„œë²„ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸
- `generate-version.sh`: ìë™ ë²„ì „ ìƒì„± ìŠ¤í¬ë¦½íŠ¸
- `run-workflow.sh`: ì „ì²´ ì›Œí¬í”Œë¡œìš° í†µí•© ì‹¤í–‰ ìŠ¤í¬ë¦½íŠ¸

### í”„ë¡œë•ì…˜ ì„¤ì •
- `docker-compose-prod.yml`: Docker Hub ì´ë¯¸ì§€ ê¸°ë°˜ í”„ë¡œë•ì…˜ìš© ì„¤ì •
- `VERSION_MANAGEMENT.md`: ì´ë¯¸ì§€ ë²„ì „ ê´€ë¦¬ ì „ëµ ê°€ì´ë“œ

## ğŸš€ ë¹ ë¥¸ ì‹œì‘ (5ë‹¨ê³„)

### 1ë‹¨ê³„: Docker Hub ë ˆí¬ì§€í† ë¦¬ ì¤€ë¹„
```bash
# Docker Hubì—ì„œ ë‹¤ìŒ ë ˆí¬ì§€í† ë¦¬ ìƒì„± (Private ê¶Œì¥):
# - stock-analysis-backend
# - stock-analysis-frontend  
# - stock-analysis-nginx

# Docker Hub ë¡œê·¸ì¸
docker login
```

### 2ë‹¨ê³„: ìë™ ë²„ì „ ìƒì„± (ì„ íƒì‚¬í•­)
```bash
# ê°œë°œ ë²„ì „ ìë™ ìƒì„±
scripts/generate-version.sh

# ì•ˆì • ë²„ì „ ìƒì„±
scripts/generate-version.sh --stable --patch    # v1.0.1
scripts/generate-version.sh --stable --minor    # v1.1.0
scripts/generate-version.sh --stable v1.2.3     # ì§ì ‘ ì§€ì •
```

### 3ë‹¨ê³„: Docker ì´ë¯¸ì§€ ë¹Œë“œ ë° ì—…ë¡œë“œ
```bash
# ì „ì²´ ì›Œí¬í”Œë¡œìš° (ì¶”ì²œ)
DOCKER_USERNAME=yourusername scripts/run-workflow.sh

# ë˜ëŠ” ë‹¨ê³„ë³„ ì‹¤í–‰
DOCKER_USERNAME=yourusername VERSION=latest scripts/build-images.sh
DOCKER_USERNAME=yourusername VERSION=latest scripts/push-images.sh
```

### 4ë‹¨ê³„: ì›ê²© ì„œë²„ ë°°í¬
```bash
# ì›ê²© ì„œë²„ì— ì ‘ì†
ssh root@158.247.216.21

# ì›ê²© ì„œë²„ì—ì„œ ë°°í¬
DOCKER_USERNAME=yourusername IMAGE_VERSION=latest bash deploy-remote.sh
```

### 5ë‹¨ê³„: ì„œë¹„ìŠ¤ í™•ì¸
```bash
# ì›ê²© ì„œë²„ì—ì„œ ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
docker compose -f docker-compose-prod.yml ps

# ì›¹ì‚¬ì´íŠ¸ ì ‘ê·¼ í™•ì¸
curl http://158.247.216.21
```

## ğŸ“‹ ìƒì„¸ ì›Œí¬í”Œë¡œìš°

### ë¡œì»¬ ê°œë°œ í™˜ê²½

#### Docker ì´ë¯¸ì§€ ë¹Œë“œ
```bash
# ëª¨ë“  ì´ë¯¸ì§€ ë¹Œë“œ
scripts/build-images.sh

# ë‹¨ì¼ ì„œë¹„ìŠ¤ ë¹Œë“œ
scripts/build-images.sh --backend
scripts/build-images.sh --frontend
scripts/build-images.sh --nginx
```

#### Docker Hub ì—…ë¡œë“œ
```bash
# ëª¨ë“  ì´ë¯¸ì§€ ì—…ë¡œë“œ
scripts/push-images.sh

# ìƒíƒœ í™•ì¸
scripts/push-images.sh --check

# ë‹¨ì¼ ì„œë¹„ìŠ¤ ì—…ë¡œë“œ
scripts/push-images.sh --backend
```

### ì›ê²© ì„œë²„ í™˜ê²½

#### ì„œë¹„ìŠ¤ ë°°í¬
```bash
# ì „ì²´ ë°°í¬
DOCKER_USERNAME=yourusername IMAGE_VERSION=latest scripts/deploy-remote.sh

# íŠ¹ì • ë‹¨ê³„ë§Œ ì‹¤í–‰
scripts/deploy-remote.sh --pull          # ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œë§Œ
scripts/deploy-remote.sh --start         # ì»¨í…Œì´ë„ˆ ì‹œì‘ë§Œ
scripts/deploy-remote.sh --stop          # ì»¨í…Œì´ë„ˆ ì¤‘ì§€ë§Œ
scripts/deploy-remote.sh --restart       # ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
scripts/deploy-remote.sh --logs          # ë¡œê·¸ í™•ì¸
scripts/deploy-remote.sh --backup        # ë°±ì—…ë§Œ ìˆ˜í–‰
```

#### ì„œë¹„ìŠ¤ ëª¨ë‹ˆí„°ë§
```bash
# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
scripts/deploy-remote.sh --check

# ì»¨í…Œì´ë„ˆ ë¡œê·¸ ì¶”ì 
docker compose -f docker-compose-prod.yml logs -f

# íŠ¹ì • ì„œë¹„ìŠ¤ ë¡œê·¸
docker compose -f docker-compose-prod.yml logs -f stock-analysis-backend
```

## ğŸ”„ ì´ì „ ë°©ì‹ vs ìƒˆë¡œìš´ ë°©ì‹ ë¹„êµ

### ì´ì „ ë°©ì‹ (íŒŒì¼ ë³µì‚¬)
```
1. ë¡œì»¬ì—ì„œ íŒŒì¼ ìˆ˜ì •
2. ì›ê²© ì„œë²„ì— íŒŒì¼ ë³µì‚¬ (rsync, scp ë“±)
3. ì›ê²© ì„œë²„ì—ì„œ Docker ë¹Œë“œ
4. ì›ê²© ì„œë²„ì—ì„œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
```

**ë¬¸ì œì :**
- ì›ê²© ì„œë²„ì—ì„œ ë¹Œë“œì‹œê°„ ì¦ê°€
- ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ ì†Œëª¨
- ì›ê²© ì„œë²„ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©
- ì—¬ëŸ¬ ì„œë²„ ì‹œ ë³µì¡ì„± ì¦ê°€

### ìƒˆë¡œìš´ ë°©ì‹ (Docker Hub)
```
1. ë¡œì»¬ì—ì„œ Docker ë¹Œë“œ
2. Docker Hubì— ì—…ë¡œë“œ
3. ì›ê²© ì„œë²„ì—ì„œ Docker Hubì—ì„œ ë‹¤ìš´ë¡œë“œ
4. ì›ê²© ì„œë²„ì—ì„œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰
```

**ì¥ì :**
- ì›ê²© ì„œë²„ ë¹Œë“œì‹œê°„ ì—†ìŒ
- ë¡œì»¬ ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­ë§Œ ì‚¬ìš©
- ì¼ê´€ëœ ì´ë¯¸ì§€ ë³´ì¥
- ì‰¬ìš´ ë¡¤ë°± ê°€ëŠ¥
- ë©€í‹° ì„œë²„ ë°°í¬ ìš©ì´

## ğŸ“Š ë²„ì „ ê´€ë¦¬ ì „ëµ

### ê°œë°œ ë²„ì „ (main ë¸Œëœì¹˜)
```bash
# ìë™ ìƒì„±: dev-YYYYMMDD-HASH
scripts/generate-version.sh
# ê²°ê³¼: dev-20251030-a1b2c3d
```

### ì•ˆì • ë²„ì „ (Git íƒœê·¸)
```bash
# Patch ì—…ë°ì´íŠ¸
scripts/generate-version.sh --stable --patch
# ê²°ê³¼: v1.0.1

# Minor ì—…ë°ì´íŠ¸  
scripts/generate-version.sh --stable --minor
# ê²°ê³¼: v1.1.0

# Major ì—…ë°ì´íŠ¸
scripts/generate-version.sh --stable --major
# ê²°ê³¼: v2.0.0
```

### ë²„ì „ ë°°í¬ ì›Œí¬í”Œë¡œìš°
```bash
# 1. ë²„ì „ ìƒì„±
scripts/generate-version.sh --stable --patch

# 2. ë¹Œë“œ ë° ì—…ë¡œë“œ
DOCKER_USERNAME=yourusername VERSION=v1.0.1 scripts/run-workflow.sh

# 3. ì›ê²© ì„œë²„ ë°°í¬
DOCKER_USERNAME=yourusername IMAGE_VERSION=v1.0.1 scripts/deploy-remote.sh

# 4. ë¡¤ë°± (í•„ìš”ì‹œ)
DOCKER_USERNAME=yourusername IMAGE_VERSION=v1.0.0 scripts/deploy-remote.sh
```

## ğŸ”§ í™˜ê²½ ë³€ìˆ˜ ë° ì„¤ì •

### Docker Hub ì„¤ì •
```bash
export DOCKER_USERNAME="your-dockerhub-username"
```

### ë²„ì „ ì„¤ì •
```bash
export VERSION="latest"           # ê°œë°œìš©
export VERSION="v1.0.0"           # ì•ˆì • ë²„ì „
export VERSION="dev-20251030-abc1234"  # ê°œë°œ ë²„ì „
```

### ì´ë¯¸ì§€ í¬ê¸° ìµœì í™”
- **ë°±ì—”ë“œ**: Python slim ì´ë¯¸ì§€ + uv ì‚¬ìš©
- **í”„ë¡ íŠ¸ì—”ë“œ**: Multi-stage buildë¡œ ìµœì í™”
- **Nginx**: Alpine ê¸°ë°˜ ê²½ëŸ‰ ì´ë¯¸ì§€

## ğŸš¨ ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ë¬¸ì œ

#### 1. Docker Hub ì—…ë¡œë“œ ì‹¤íŒ¨
```bash
# ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
docker login

# ë ˆí¬ì§€í† ë¦¬ ì ‘ê·¼ ê¶Œí•œ í™•ì¸
docker info | grep "Username"
```

#### 2. ì›ê²© ì„œë²„ ë°°í¬ ì‹¤íŒ¨
```bash
# ê¸°ì¡´ ì»¨í…Œì´ë„ˆ í™•ì¸
docker compose -f docker-compose-prod.yml ps

# ìˆ˜ë™ìœ¼ë¡œ ì»¨í…Œì´ë„ˆ ì¤‘ì§€
docker compose -f docker-compose-prod.yml down

# ë””ìŠ¤í¬ ê³µê°„ í™•ì¸
df -h
docker system df
```

#### 3. ì„œë¹„ìŠ¤ ì ‘ì† ë¶ˆê°€
```bash
# ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker compose -f docker-compose-prod.yml ps

# ë¡œê·¸ í™•ì¸
docker compose -f docker-compose-prod.yml logs

# ë„¤íŠ¸ì›Œí¬ í™•ì¸
docker network ls
docker network inspect stock-analysis_stock-analysis-network
```

#### 4. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ë¬¸ì œ
```bash
# ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœ í™•ì¸
docker exec stock-analysis-postgres pg_isready

# ì—°ê²° í…ŒìŠ¤íŠ¸
docker exec stock-analysis-backend python -c "
import os
from sqlalchemy import create_engine
engine = create_engine(os.getenv('DATABASE_URL'))
engine.connect()
print('DB ì—°ê²° ì„±ê³µ')
"
```

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### Docker Hub ë ˆí¬ì§€í† ë¦¬
- **Private ë ˆí¬ì§€í† ë¦¬ ì‚¬ìš© ê¶Œì¥**
- **ê¸°ì–µí•  ìˆ˜ ì—†ëŠ” ë¹„ë°€ë²ˆí˜¸ë¡œ ì„¤ì •**
- **ì •ê¸°ì ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½**

### í™˜ê²½ ë³€ìˆ˜ ë³´ì•ˆ
```bash
# ë¯¼ê°í•œ ì •ë³´ëŠ” í™˜ê²½ íŒŒì¼ì— ì €ì¥
POSTGRES_PASSWORD=your-secure-password
NEXTAUTH_SECRET=your-secret-key
ADMIN_PASSWORD=your-admin-password
```

### ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ
- **Nginx í”„ë¡ì‹œ ì‚¬ìš©ìœ¼ë¡œ í¬íŠ¸ 8000, 3000 ë¹„ê³µê°œ**
- **HTTPS ì ìš© ê¶Œì¥**
- **ë°©í™”ë²½ ì„¤ì •ìœ¼ë¡œ í•„ìš” í¬íŠ¸ë§Œ ê°œë°©**

## ğŸ“ˆ ëª¨ë‹ˆí„°ë§ ë° ë°±ì—…

### ë°±ì—… ìë™í™”
```bash
# ì£¼ê¸°ì  ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…
0 2 * * * DOCKER_USERNAME=yourusername /path/to/scripts/deploy-remote.sh --backup

# ë¡œê·¸ ë¡œí…Œì´ì…˜
docker compose -f docker-compose-prod.yml logs --max-size 100m --max-file 3
```

### ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
```bash
# ì»¨í…Œì´ë„ˆ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
docker stats

# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰
docker system df

# ì„œë¹„ìŠ¤ë³„ ìƒì„¸ ì •ë³´
docker inspect stock-analysis-backend
```

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

### ê³ ê¸‰ ê¸°ëŠ¥
1. **CI/CD íŒŒì´í”„ë¼ì¸ ìë™í™”** (GitHub Actions, GitLab CI ë“±)
2. **Kubernetes ë°°í¬**ë¡œ í™•ì¥
3. **Prometheus + Grafana** ëª¨ë‹ˆí„°ë§
4. **ELK Stack** ë¡œê¹…
5. **Blue-Green ë°°í¬** ì „ëµ

### ìµœì í™”
1. **Docker ì´ë¯¸ì§€ ìºì‹±** ìµœì í™”
2. **ë©€í‹° ì•„í‚¤í…ì²˜** ì§€ì› (ARM64, AMD64)
3. **ì´ë¯¸ì§€ ìŠ¤ìºë‹** (Vulnerability scanning)
4. **ë ˆì§€ìŠ¤íŠ¸ë¦¬ ë¯¸ëŸ¬ë§** (Private registry)

## ğŸ“ ì§€ì› ë° ì—°ë½ì²˜

### ë¬¸ì œ ë°œìƒ ì‹œ
1. **ë¡œê·¸ í™•ì¸**: ê° ìŠ¤í¬ë¦½íŠ¸ì˜ ë¡œê·¸ ì„¹ì…˜ ì°¸ì¡°
2. **ë¬¸ì„œ í™•ì¸**: ê´€ë ¨ ê°€ì´ë“œ ë¬¸ì„œ í™•ì¸
3. **ì»¤ë®¤ë‹ˆí‹°**: Docker, GitHub ì´ìŠˆ í™œìš©

### ì—…ë°ì´íŠ¸ ì•Œë¦¼
- **Docker Hub ë ˆí¬ì§€í† ë¦¬** ëª¨ë‹ˆí„°ë§
- **GitHub** ë¦´ë¦¬ìŠ¤ ë…¸íŠ¸ í™•ì¸
- **ë³´ì•ˆ ì—…ë°ì´íŠ¸** ì •ê¸° ì ìš©